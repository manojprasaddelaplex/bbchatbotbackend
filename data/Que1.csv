question,sql
"How many referrals were reported between Friday and 0600hrs on Monday in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Provide the daily referral numbers from Friday to 0600hrs Monday for the force area.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What was the number of referrals received in the force area from Friday to Monday morning at 0600hrs?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can you share the count of referrals per day in the force area from Friday to 0600hrs on Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals came in from Friday to 0600hrs Monday within the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Provide the referral statistics from Friday through to 0600hrs on Monday in the force jurisdiction.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"From Friday to 0600hrs on Monday, how many referrals were registered in the force's area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What were the daily referral numbers for the force area from Friday to 0600hrs on Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
Could you break down the number of referrals per day from Friday to Monday morning in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were made in the force area from Friday until 0600hrs on Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What was the total number of referrals per day in the force's area between Friday and 0600hrs on Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can you provide the referral data from Friday through 0600hrs Monday in the force region?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Share the daily referral figures from Friday to 0600hrs Monday in the force area.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were filed in the force area from Friday to 0600hrs Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What are the referral counts from Friday to Monday 0600hrs in the force's jurisdiction?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Provide the number of referrals per day for the force area from Friday to 0600hrs on Monday.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Could you provide referral statistics from Friday to 0600hrs Monday for the force region?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were reported each day between Friday and Monday 0600hrs in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can I get the referral figures from Friday to 0600hrs on Monday for the force’s area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were recorded from Friday through 0600hrs on Monday in the force region?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What were the daily referral numbers in the force area from Friday through 0600hrs Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can you provide the referral count per day from Friday to Monday morning 0600hrs in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What is the number of referrals reported between Friday and 0600hrs Monday within the force jurisdiction?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Share the referral numbers for each day from Friday to 0600hrs on Monday in the force's area.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What are the referral statistics from Friday to 0600hrs on Monday for the force's region?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were received per day from Friday through Monday 0600hrs in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Could you break down the number of referrals registered from Friday until 0600hrs Monday in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Provide the daily referral data from Friday to 0600hrs Monday in the force's area.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were submitted in the force's region between Friday and Monday 0600hrs?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What was the daily referral count from Friday to Monday morning 0600hrs in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Provide the referral totals from Friday until 0600hrs Monday in the force’s jurisdiction.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Could you give me the daily referral statistics for the force area between Friday and 0600hrs Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were logged in the force area from Friday to 0600hrs on Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Share the referral count for each day from Friday to Monday 0600hrs in the force region.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What was the total referral number per day in the force area from Friday through 0600hrs Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can you provide the referral figures for each day from Friday to Monday 0600hrs in the force jurisdiction?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Could you provide the referral breakdown from Friday to Monday 0600hrs in the force region?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were registered each day in the force area from Friday through to Monday 0600hrs?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can you give me the referral count from Friday to 0600hrs Monday for the force jurisdiction?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What are the daily referral numbers in the force area between Friday and Monday 0600hrs?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were made per day from Friday to Monday 0600hrs in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Provide the referral count for each day in the force area from Friday through to Monday 0600hrs.","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can you give a breakdown of the referral numbers per day from Friday to Monday 0600hrs in the force region?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What were the referral figures for each day in the force area from Friday to 0600hrs Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were filed per day in the force jurisdiction between Friday and 0600hrs Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"What were the total referrals per day from Friday to 0600hrs Monday in the force’s region?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Can I get the daily referral data from Friday through 0600hrs Monday in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were recorded per day from Friday until Monday 0600hrs in the force jurisdiction?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"Could you provide the number of referrals logged in the force area from Friday to 0600hrs Monday?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"How many referrals were reported per day from Friday to Monday 0600hrs in the force area?","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"
"From Friday to 0600hrs on Monday can you provide me with the number of referrals in the force area per day","WITH WeekendData AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE)) AS WeekendStart, COUNT(*) AS ReferralCount FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(MONTH, -1, GETDATE()) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6)) GROUP BY DATEADD(DAY, -((DATEPART(WEEKDAY, ReferralCreatedDateTime) + 1) % 7), CAST(ReferralCreatedDateTime AS DATE))), ThisWeekend AS (SELECT DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AS ThisWeekendStart, COUNT(*) AS TotalThisWeekendReferrals FROM Referrals WHERE ReferralCreatedDateTime >= DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE)) AND ReferralCreatedDateTime < DATEADD(DAY, 3, DATEADD(DAY, -((DATEPART(WEEKDAY, GETDATE()) + 1) % 7), CAST(GETDATE() AS DATE))) AND (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 6 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 7 OR DATEPART(WEEKDAY, ReferralCreatedDateTime) = 1 OR (DATEPART(WEEKDAY, ReferralCreatedDateTime) = 2 AND DATEPART(HOUR, ReferralCreatedDateTime) < 6))), PreviousWeekends AS (SELECT AVG(ReferralCount) AS AvgPreviousWeekendReferrals, SUM(ReferralCount) AS TotalPreviousWeekendReferrals FROM WeekendData WHERE WeekendStart < (SELECT ThisWeekendStart FROM ThisWeekend)) SELECT ThisWeekend.TotalThisWeekendReferrals, PreviousWeekends.AvgPreviousWeekendReferrals, PreviousWeekends.TotalPreviousWeekendReferrals, CASE WHEN ThisWeekend.TotalThisWeekendReferrals > PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Above Average' WHEN ThisWeekend.TotalThisWeekendReferrals < PreviousWeekends.AvgPreviousWeekendReferrals THEN 'Below Average' ELSE 'Equal to Average' END AS ComparisonResult FROM ThisWeekend, PreviousWeekends;"